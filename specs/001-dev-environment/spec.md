# Feature Specification: 開発環境セットアップ

**Feature Branch**: `001-dev-environment`
**Created**: 2026-01-13
**Status**: Draft
**Input**: User description: "開発環境を作って"

## User Scenarios & Testing _(mandatory)_

### User Story 1 - 初回環境構築 (Priority: P1)

新規開発者がプロジェクトに参加した際に、最小限のコマンドで開発環境を立ち上げ、すぐにコーディングを開始できる。

**Why this priority**: 開発者がプロジェクトに参加してから実際に開発を始めるまでの時間を最小化することが、生産性向上の第一歩であるため。

**Independent Test**: リポジトリをクローン後、セットアップコマンドを実行し、アプリケーションがローカルで動作することを確認することで検証可能。

**Acceptance Scenarios**:

1. **Given** リポジトリをクローンした状態, **When** セットアップスクリプトを実行する, **Then** 必要な依存関係がすべてインストールされる
2. **Given** 依存関係がインストールされた状態, **When** 開発サーバー起動コマンドを実行する, **Then** ローカル環境でアプリケーションにアクセスできる
3. **Given** 環境変数の設定が必要な状態, **When** セットアップを完了する, **Then** テンプレートファイルから環境変数ファイルが生成される

---

### User Story 2 - ローカル開発サーバー起動 (Priority: P1)

開発者が日常的にコード変更をリアルタイムで確認しながら開発作業を行える。

**Why this priority**: ホットリロードによる即座のフィードバックは開発効率に直結するため、初回環境構築と同等の重要度を持つ。

**Independent Test**: コードを変更し、ブラウザをリロードせずに変更が反映されることを確認することで検証可能。

**Acceptance Scenarios**:

1. **Given** 開発環境が構築済みの状態, **When** 開発サーバーを起動する, **Then** 指定されたポートでアプリケーションにアクセスできる
2. **Given** 開発サーバーが起動している状態, **When** ソースコードを変更する, **Then** 変更が自動的に反映される（ホットリロード）
3. **Given** 開発サーバーが起動している状態, **When** ビルドエラーが発生する, **Then** エラー内容がわかりやすく表示される

---

### User Story 3 - コード品質チェック (Priority: P2)

開発者がコードをコミットする前に、コードフォーマットと静的解析を実行して品質を担保できる。

**Why this priority**: コード品質の一貫性はチーム開発において重要だが、まずはアプリケーションが動作することが前提となるため P2。

**Independent Test**: 意図的にフォーマットを崩したコードに対してリンターを実行し、問題が検出されることを確認することで検証可能。

**Acceptance Scenarios**:

1. **Given** コードが存在する状態, **When** リントコマンドを実行する, **Then** コードスタイルの問題が検出・報告される
2. **Given** フォーマットされていないコードがある状態, **When** フォーマットコマンドを実行する, **Then** コードが自動的に整形される
3. **Given** 型エラーがあるコードが存在する状態, **When** 型チェックを実行する, **Then** 型の問題が検出・報告される

---

### User Story 4 - テスト実行 (Priority: P2)

開発者がユニットテストを実行して、コード変更が既存機能を壊していないことを確認できる。

**Why this priority**: テストは品質保証に不可欠だが、基本的な開発フローが確立された後に活用されるため P2。

**Independent Test**: テストコマンドを実行し、テスト結果が表示されることを確認することで検証可能。

**Acceptance Scenarios**:

1. **Given** テストファイルが存在する状態, **When** テストコマンドを実行する, **Then** すべてのテストが実行され結果が表示される
2. **Given** テストが実行可能な状態, **When** 特定のテストファイルを指定して実行する, **Then** 指定したテストのみが実行される
3. **Given** テストが失敗する状態, **When** テストを実行する, **Then** 失敗したテストの詳細情報が表示される

---

### User Story 5 - ビルド実行 (Priority: P3)

開発者が本番環境向けのビルドを実行して、デプロイ前に問題がないことを確認できる。

**Why this priority**: 本番ビルドは開発の最終段階で必要となるため、日常的な開発フローより優先度は低い。

**Independent Test**: ビルドコマンドを実行し、出力ディレクトリに成果物が生成されることを確認することで検証可能。

**Acceptance Scenarios**:

1. **Given** ソースコードが存在する状態, **When** ビルドコマンドを実行する, **Then** 最適化された本番用ファイルが生成される
2. **Given** ビルドが完了した状態, **When** 生成されたファイルを確認する, **Then** 必要なすべてのアセットが含まれている

---

### Edge Cases

- **依存関係のバージョン競合**: パッケージ間でバージョン競合が発生した場合、明確なエラーメッセージを表示する
- **ポート使用中**: 開発サーバーのポートが既に使用されている場合、代替ポートの使用を提案するか、エラーを表示する
- **環境変数不足**: 必須の環境変数が設定されていない場合、アプリケーション起動前に警告を表示する
- **Node.jsバージョン不一致**: 推奨されるNode.jsバージョンと異なる場合、警告を表示する

## Requirements _(mandatory)_

### Functional Requirements

- **FR-001**: System MUST 単一のコマンドで依存関係をインストールできる
- **FR-002**: System MUST 環境変数のテンプレートファイルを提供する
- **FR-003**: System MUST ホットリロード対応の開発サーバーを起動できる
- **FR-004**: System MUST コードフォーマッターを実行できる
- **FR-005**: System MUST 静的解析（リンター）を実行できる
- **FR-006**: System MUST 型チェックを実行できる
- **FR-007**: System MUST ユニットテストを実行できる
- **FR-008**: System MUST 本番用ビルドを生成できる
- **FR-009**: System MUST 推奨されるNode.jsバージョンをドキュメントで明示する
- **FR-010**: System MUST 各コマンドの使用方法をREADMEで説明する

### Key Entities

- **開発環境設定**: プロジェクトのルートに配置される設定ファイル群（パッケージ管理、リンター設定、テスト設定など）
- **環境変数**: アプリケーションの動作に必要な設定値（API エンドポイント、認証情報など）
- **ビルド成果物**: 本番環境にデプロイ可能な最適化されたファイル群

## Success Criteria _(mandatory)_

### Measurable Outcomes

- **SC-001**: 新規開発者がリポジトリをクローンしてから開発サーバーを起動するまでの時間が5分以内
- **SC-002**: 開発サーバー起動後、コード変更がブラウザに反映されるまでの時間が3秒以内
- **SC-003**: セットアップ手順がREADMEに記載され、手順通りに実行することで100%成功する
- **SC-004**: リントとフォーマットコマンドがプロジェクト全体のコードに対して実行可能
- **SC-005**: テストコマンドが正常に実行され、結果が明確に表示される
- **SC-006**: 本番ビルドが正常に完了し、デプロイ可能な成果物が生成される

## Clarifications

### Session 2026-01-13

- Q: アプリケーションの種類は何ですか？ → A: Next.js（Reactベースのフルスタックフレームワーク）
- Q: パッケージマネージャーはどれを使用しますか？ → A: pnpm（高速・ディスク効率的・厳格な依存管理）
- Q: テストフレームワークは？ → A: Vitest + React Testing Library（constitution.mdより）
- Q: その他の技術スタックは？ → A: constitution.mdに定義済み（Tailwind CSS, shadcn/ui, ESLint + Prettier, Zod, Prisma, Better Auth等）

## Assumptions

- プロジェクトはNext.js (App Router) ベースのフルスタックWebアプリケーション
- 技術スタックは `.specify/memory/constitution.md` に定義されたものを使用
- 開発者のローカルマシンにNode.jsとpnpmがインストール済み
- 開発者はターミナル/コマンドラインの基本操作に習熟している
- バージョン管理にはGitを使用
- TDD（テスト駆動開発）を採用（constitution.md Principle I）
